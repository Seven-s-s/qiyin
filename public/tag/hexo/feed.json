{
    "version": "https://jsonfeed.org/version/1",
    "title": "七音 • All posts by \"hexo\" tag",
    "description": "路漫漫其修远兮，吾将上下而求索",
    "home_page_url": "https://qiyins.cn",
    "items": [
        {
            "id": "https://qiyins.cn/computer/Hexo/",
            "url": "https://qiyins.cn/computer/Hexo/",
            "title": "hexo的使用",
            "date_published": "2020-12-15T16:00:00.000Z",
            "content_html": "<h2 id=\"安装hexo\"><a class=\"anchor\" href=\"#安装hexo\">#</a> 安装 Hexo</h2>\n<h3 id=\"第一步安装nodejs\"><a class=\"anchor\" href=\"#第一步安装nodejs\">#</a> 第一步安装 Nodejs</h3>\n<ol>\n<li>\n<p>下载</p>\n<blockquote>\n<p>wget <span class=\"exturl\" data-url=\"aHR0cHM6Ly9ub2RlanMub3JnL2Rpc3QvdjEyLjE4LjEvbm9kZS12MTIuMTguMS1saW51eC14NjQudGFyLnh6\">https://nodejs.org/dist/v12.18.1/node-v12.18.1-linux-x64.tar.xz</span></p>\n</blockquote>\n</li>\n<li>\n<p>解压</p>\n<blockquote>\n<p>tar xf node-v12.18.1-linux-x64.tar.xz</p>\n</blockquote>\n</li>\n<li>\n<p>进入解压目录</p>\n<blockquote>\n<p>cd node-v12.18.1-linux-x64</p>\n</blockquote>\n</li>\n<li>\n<p>执行 node 命令，查看版本</p>\n<blockquote>\n<p>./bin/node -v</p>\n</blockquote>\n</li>\n<li>\n<p>修改文件的名字</p>\n<blockquote>\n<p>mv node-v12.18.1-linux-x64 nodejs</p>\n</blockquote>\n</li>\n<li>\n<p>映射配置全局 node</p>\n<blockquote>\n<p>ln -s /node 的路径 /bin/node/usr/local/bin/</p>\n<p>ln -s /node 的路径 /bin/npm/usr/local/bin/</p>\n</blockquote>\n</li>\n<li>\n<p>配置环境变量</p>\n<blockquote>\n<p>vi /etc/profile</p>\n<p>在最后一行添加</p>\n<p>export NODE_HOME=node 的路径</p>\n<p>export PATH=<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>P</mi><mi>A</mi><mi>T</mi><mi>H</mi><mo>:</mo></mrow><annotation encoding=\"application/x-tex\">PATH:</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.68333em;vertical-align:0em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">P</span><span class=\"mord mathnormal\">A</span><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">T</span><span class=\"mord mathnormal\" style=\"margin-right:0.08125em;\">H</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span><span class=\"mrel\">:</span></span></span></span>NODE_HOME/bin</p>\n<p>export NODE_PATH=$NODE_HOME/lib/node_modules</p>\n</blockquote>\n</li>\n<li>\n<p>执行命令 source /etc/profile 及在当前控制台更新</p>\n</li>\n</ol>\n<h3 id=\"第二部安装git\"><a class=\"anchor\" href=\"#第二部安装git\">#</a> 第二部安装 Git</h3>\n<blockquote>\n<p>yum install git</p>\n</blockquote>\n<h3 id=\"第三步安装hexo\"><a class=\"anchor\" href=\"#第三步安装hexo\">#</a> 第三步安装 hexo</h3>\n<blockquote>\n<pre><code>npm install -g hexo-cli\n</code></pre>\n</blockquote>\n<h2 id=\"基本操作\"><a class=\"anchor\" href=\"#基本操作\">#</a> 基本操作</h2>\n<p>新建一个文件，用来写博客的，在该文件下初始化</p>\n<blockquote>\n<p>hexo init</p>\n</blockquote>\n<p>初始化模板</p>\n<blockquote>\n<p>hexo generate</p>\n</blockquote>\n<p>运行该模板</p>\n<blockquote>\n<p>hexo server</p>\n</blockquote>\n<h2 id=\"基于宝塔面板意见部署hexo博客\"><a class=\"anchor\" href=\"#基于宝塔面板意见部署hexo博客\">#</a> 基于宝塔面板意见部署 hexo 博客</h2>\n<h3 id=\"创建git用户\"><a class=\"anchor\" href=\"#创建git用户\">#</a> 创建 git 用户</h3>\n<ol>\n<li>\n<p>创建 git 用户</p>\n<blockquote>\n<p>adduser git</p>\n</blockquote>\n</li>\n<li>\n<p>获取权限</p>\n<blockquote>\n<p>chmod 740 /etc/sudoers</p>\n<p>vim /etc/sudoers</p>\n</blockquote>\n</li>\n<li>\n<p>按  <code>i</code>  键进入文件的编辑模式，按向下键找到如下字段</p>\n<blockquote>\n<p>root    ALL=(ALL)       ALL</p>\n</blockquote>\n</li>\n<li>\n<p>在其后面增加一句</p>\n<blockquote>\n<p>git     ALL=(ALL)       ALL</p>\n</blockquote>\n</li>\n<li>\n<p>按  <code>Esc</code>  键退出编辑模式，输入 <code>:wq</code>  保存退出。（先输入 <code>:</code> ，然后输入 <code>wq</code>  回车）</p>\n<blockquote>\n<p>chmod 400 /etc/sudoers</p>\n</blockquote>\n</li>\n</ol>\n<h3 id=\"配置密钥\"><a class=\"anchor\" href=\"#配置密钥\">#</a> 配置密钥</h3>\n<ol>\n<li>\n<p>创建密钥</p>\n<blockquote>\n<p>一般存放在 <code>c/用户/.ssh</code>  下。</p>\n</blockquote>\n</li>\n<li>\n<p>将 <code>id_rsa.pub</code>  里面的密钥复制，在服务器运行下面命令，创建.ssh 文件夹</p>\n<blockquote>\n<p>su git</p>\n<p>mkdir ~/.ssh</p>\n</blockquote>\n</li>\n<li>\n<p>创建 <code>.ssh/authorized_keys</code>  文件，打开 <code>authorized_keys</code>  文件并将刚才在本地机器复制的内容拷贝其中并保存</p>\n<blockquote>\n<p>vim ~/.ssh/authorized_keys</p>\n</blockquote>\n</li>\n<li>\n<p>按 <code>i</code>  进入编辑模式粘贴完按  <code>Esc</code>  键退出编辑模式，输入 <code>:wq</code>  保存退出。（先输入 <code>:</code> ，然后输入 <code>wq</code>  回车）</p>\n<ul>\n<li>\n<p>修改权限</p>\n<blockquote>\n<p>chmod 755 ~</p>\n</blockquote>\n</li>\n</ul>\n</li>\n</ol>\n<blockquote>\n<p>chmod 700 ~/.ssh</p>\n<p>chmod 600 ~/.ssh/authorized_keys</p>\n</blockquote>\n<ul>\n<li>\n<p>测试本地连接服务器（在本地电脑 git bash here）</p>\n<blockquote>\n<p>//yourIp 为远程服务器的 ip 地址</p>\n<p>ssh -v git@yourIp     //yourIp 为你的服务器 ip</p>\n</blockquote>\n</li>\n<li>\n<p>如果出现 Welcome to xxx 则表示连接成功</p>\n</li>\n</ul>\n<h3 id=\"创建git仓库\"><a class=\"anchor\" href=\"#创建git仓库\">#</a> 创建 git 仓库</h3>\n<ul>\n<li>\n<p>切换到 root 用户，创建一个目录用于存储网站的根目录</p>\n<blockquote>\n<p>su root</p>\n</blockquote>\n</li>\n<li>\n<p>创建网站的根目录</p>\n<blockquote>\n<p>mkdir /home/hexo</p>\n</blockquote>\n</li>\n<li>\n<p>给予权限</p>\n<blockquote>\n<p>chown git:git -R /home/hexo</p>\n</blockquote>\n</li>\n</ul>\n<h3 id=\"自动化部署\"><a class=\"anchor\" href=\"#自动化部署\">#</a> 自动化部署</h3>\n<ul>\n<li>\n<p>获取 root 权限</p>\n<blockquote>\n<p>su root</p>\n</blockquote>\n</li>\n<li>\n<p>建立 git 仓库</p>\n<blockquote>\n<p>cd /home/git</p>\n<p>git init --bare blog.git</p>\n</blockquote>\n</li>\n<li>\n<p>修改 blog.git 权限</p>\n<blockquote>\n<p>chown git:git -R blog.git</p>\n</blockquote>\n</li>\n<li>\n<p>在  <code>/home/hexo/blog.git</code>  下，有一个自动生成的  <code>hooks</code>  文件夹，我们创建一个新的  <code>git</code>  钩子  <code>post-receive</code> ，用于自动部署。</p>\n<blockquote>\n<p>vim blog.git/hooks/post-receive</p>\n</blockquote>\n</li>\n<li>\n<p>按  <code>i</code>  键进入文件的编辑模式，在该文件中添加两行代码（将下边的代码粘贴进去)，指定 Git 的工作树（源代码）和 Git 目录</p>\n<blockquote>\n<p><em>#!/bin/bash</em></p>\n<p>git --work-tree=/home/hexo --git-dir=/home/git/blog.git checkout -f</p>\n</blockquote>\n</li>\n<li>\n<p>按  <code>Esc</code>  键退出编辑模式，输入 <code>:wq</code>  保存退出。（先输入 <code>：</code> ，然后输入 <code>wq</code>  回车）</p>\n</li>\n<li>\n<p>修改文件权限，使得其可执行</p>\n<blockquote>\n<p>chmod +x /home/git/blog.git/hooks/post-receive</p>\n</blockquote>\n</li>\n</ul>\n<h3 id=\"添加网站\"><a class=\"anchor\" href=\"#添加网站\">#</a> 添加网站</h3>\n<p>点击添加网站<strong>→</strong>添加站点</p>\n<blockquote>\n<p>输入域名 + 根目录（/home/hexo）</p>\n</blockquote>\n<h3 id=\"配置本地hexo\"><a class=\"anchor\" href=\"#配置本地hexo\">#</a> 配置本地 Hexo</h3>\n<ul>\n<li>\n<p>博客根目录_config 下增加</p>\n<blockquote>\n<p>deploy:</p>\n<p>​\ttype: git</p>\n<p>​    repo: root@***(服务器 ip, 内网外网都行):/home/git/blog.git    #仓库地址</p>\n<p>​    branch: master    #分支</p>\n</blockquote>\n</li>\n<li>\n<p>部署</p>\n<blockquote>\n<p>hexo clean</p>\n<p>hexo g</p>\n<p>hexo d</p>\n</blockquote>\n</li>\n</ul>\n<ul>\n<li>\n<p>输入 <code>hexo d</code>  的时候，如果出现 ERROR Deployer not found: git，输入以下命令</p>\n<blockquote>\n<p>npm install --save hexo-deployer-git</p>\n</blockquote>\n</li>\n<li>\n<p>如果出现 <code>bash: git-receive-pack: command not found</code></p>\n<blockquote>\n<p>sudo ln -s /usr/local/git/bin/git-receive-pack  /usr/bin/git-receive-pack</p>\n</blockquote>\n</li>\n</ul>\n<ul>\n<li>访问服务器 ip，看有没有成功</li>\n</ul>\n",
            "tags": [
                "hexo"
            ]
        }
    ]
}