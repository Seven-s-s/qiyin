{
    "version": "https://jsonfeed.org/version/1",
    "title": "七音 • All posts by \"redis\" tag",
    "description": "路漫漫其修远兮，吾将上下而求索",
    "home_page_url": "https://qiyins.cn",
    "items": [
        {
            "id": "https://qiyins.cn/computer/course-1/redis/",
            "url": "https://qiyins.cn/computer/course-1/redis/",
            "title": "Redis",
            "date_published": "2020-08-01T07:32:00.000Z",
            "content_html": "<h1 id=\"下载地址\"><a class=\"anchor\" href=\"#下载地址\">#</a> 下载地址</h1>\n<blockquote>\n<p><span class=\"exturl\" data-url=\"aHR0cHM6Ly9naXRodWIuY29tL21pY3Jvc29mdGFyY2hpdmUvcmVkaXMvdGFncw==\">https://github.com/microsoftarchive/redis/tags</span></p>\n</blockquote>\n<h1 id=\"基本操作\"><a class=\"anchor\" href=\"#基本操作\">#</a> 基本操作</h1>\n<h2 id=\"信息添加\"><a class=\"anchor\" href=\"#信息添加\">#</a> 信息添加</h2>\n<blockquote>\n<p>设置 key，value 数据</p>\n<p>set key value</p>\n</blockquote>\n<h2 id=\"获取值\"><a class=\"anchor\" href=\"#获取值\">#</a> 获取值</h2>\n<blockquote>\n<p>根据 key 值查找对应的 value，如果不存在，返回空（nil）;</p>\n<p>get key</p>\n</blockquote>\n<h2 id=\"清屏\"><a class=\"anchor\" href=\"#清屏\">#</a> 清屏</h2>\n<blockquote>\n<p>clear</p>\n</blockquote>\n<h2 id=\"帮助信息\"><a class=\"anchor\" href=\"#帮助信息\">#</a> 帮助信息</h2>\n<blockquote>\n<p>获取帮助文档</p>\n<p>help 命令名称</p>\n<p>Help @组名</p>\n</blockquote>\n<h2 id=\"退出\"><a class=\"anchor\" href=\"#退出\">#</a> 退出</h2>\n<blockquote>\n<p>退出客户端</p>\n<p>quit 或者 exit</p>\n</blockquote>\n<h1 id=\"数据类型\"><a class=\"anchor\" href=\"#数据类型\">#</a> <strong>数据类型</strong></h1>\n<blockquote>\n<p>String、hash、list、set、sorted_set</p>\n</blockquote>\n<h2 id=\"string\"><a class=\"anchor\" href=\"#string\">#</a> String</h2>\n<h3 id=\"基本操作-2\"><a class=\"anchor\" href=\"#基本操作-2\">#</a> 基本操作</h3>\n<ol>\n<li>\n<p>添加 / 修改数据</p>\n<blockquote>\n<p>set key value</p>\n</blockquote>\n</li>\n<li>\n<p>获取数据</p>\n<blockquote>\n<p>get key</p>\n</blockquote>\n</li>\n<li>\n<p>删除数据</p>\n<blockquote>\n<p>del key</p>\n</blockquote>\n</li>\n<li>\n<p>添加 / 几个多个数据</p>\n<blockquote>\n<p>mset key1 value1 key2 value2 …</p>\n</blockquote>\n</li>\n<li>\n<p>获取多个数据</p>\n<blockquote>\n<p>mget key1 key2 …</p>\n</blockquote>\n</li>\n<li>\n<p>获取数据字符个数</p>\n<blockquote>\n<p>strlen key</p>\n</blockquote>\n</li>\n<li>\n<p>追加信息到原始信息后部</p>\n<blockquote>\n<p>append key value</p>\n</blockquote>\n</li>\n</ol>\n<h3 id=\"拓展操作\"><a class=\"anchor\" href=\"#拓展操作\">#</a> <strong>拓展操作</strong></h3>\n<ol>\n<li>\n<p>设置数据增加指定范围的值</p>\n<blockquote>\n<p>Incr key                   对于整数加一操作</p>\n<p>lncrby key increment         增加指定的整数</p>\n<p>Incrybyfloat key increment     增加指定的浮点数</p>\n</blockquote>\n</li>\n<li>\n<p>设置数值数据减少指定范围的值</p>\n</li>\n</ol>\n<blockquote>\n<p>decr key                  对于整数减一操作</p>\n<p>decryby key increment        减少指定的整数</p>\n</blockquote>\n<ol start=\"3\">\n<li>\n<p>设置数据具有指定的生命周期</p>\n<blockquote>\n<p>setex key seconds value</p>\n<p>psetex key milliseconds value</p>\n</blockquote>\n</li>\n<li>\n<p>key 的设置约定</p>\n<blockquote>\n<p>数据库中的热点数据 key 命名惯例</p>\n<p>表名：主键名：主键值：字段名</p>\n<p>eg：order🆔123:name</p>\n</blockquote>\n</li>\n</ol>\n<h2 id=\"hash\"><a class=\"anchor\" href=\"#hash\">#</a> hash</h2>\n<h3 id=\"基本操作-3\"><a class=\"anchor\" href=\"#基本操作-3\">#</a> <strong>基本操作</strong></h3>\n<ol>\n<li>\n<p>添加 / 修改数据</p>\n<blockquote>\n<p>H  set key field value</p>\n</blockquote>\n</li>\n<li>\n<p>获取数据</p>\n</li>\n</ol>\n<blockquote>\n<p>hget key field</p>\n<p>hgetall key</p>\n</blockquote>\n<ol start=\"3\">\n<li field2=\"\">\n<p>删除数据</p>\n<blockquote>\n<p>hdel key field1</p>\n</blockquote>\n</li>\n<li>\n<p>添加 / 修改多个数据</p>\n<blockquote>\n<p>hmset key field1 value1 field2 value2</p>\n</blockquote>\n</li>\n<li>\n<p>获取多个数据</p>\n<blockquote>\n<p>hmget key field1 field2</p>\n</blockquote>\n</li>\n<li>\n<p>获取哈希表中的字段数量</p>\n<blockquote>\n<p>hlen key</p>\n</blockquote>\n</li>\n<li>\n<p>获取哈希表中是否存在指定的字段</p>\n<blockquote>\n<p>hexists key field</p>\n</blockquote>\n</li>\n</ol>\n<h3 id=\"拓展操作-2\"><a class=\"anchor\" href=\"#拓展操作-2\">#</a> <strong>拓展操作</strong></h3>\n<ol>\n<li>\n<p>获取哈希表中所有的字段名或字段值</p>\n<blockquote>\n<p>hkeys key</p>\n<p>hvals key</p>\n</blockquote>\n</li>\n<li>\n<p>设置指定字段的数据增加指定范围的值</p>\n<blockquote>\n<p>hincrby key field increment</p>\n<p>hincrbyfloat key field increment</p>\n</blockquote>\n</li>\n</ol>\n<h2 id=\"list\"><a class=\"anchor\" href=\"#list\">#</a> <strong>list</strong></h2>\n<h3 id=\"基本操作-4\"><a class=\"anchor\" href=\"#基本操作-4\">#</a> <strong>基本操作</strong></h3>\n<ol>\n<li>\n<p>添加 / 删除数据</p>\n<blockquote>\n<p>lpush key value1 {valur2} …</p>\n<p>rpush key value2 {value2} …</p>\n</blockquote>\n</li>\n<li>\n<p>获取数据</p>\n<blockquote>\n<p>lrange key start stop</p>\n<p>lindex key index</p>\n<p>llen key</p>\n</blockquote>\n</li>\n<li>\n<p>获取并移除数据</p>\n<blockquote>\n<p>lpop key</p>\n<p>rpop key</p>\n</blockquote>\n</li>\n</ol>\n<h3 id=\"拓展操作-3\"><a class=\"anchor\" href=\"#拓展操作-3\">#</a> <strong>拓展操作</strong></h3>\n<ol>\n<li>\n<p>规定时间内获取并移除数据</p>\n<blockquote>\n<p>blpop key1 {key2} timeout</p>\n<p>brpop key1 {key2} timeout</p>\n</blockquote>\n</li>\n<li>\n<p>移除指定数据</p>\n<blockquote>\n<p>lrem key count value</p>\n</blockquote>\n</li>\n</ol>\n<h2 id=\"set\"><a class=\"anchor\" href=\"#set\">#</a> set</h2>\n<h3 id=\"基本操作-5\"><a class=\"anchor\" href=\"#基本操作-5\">#</a> <strong>基本操作</strong></h3>\n<ol>\n<li member2=\"\">\n<p>添加数据</p>\n<blockquote>\n<p>sadd key member1</p>\n</blockquote>\n</li>\n<li>\n<p>获取所有数据</p>\n<blockquote>\n<p>smembers key</p>\n</blockquote>\n</li>\n<li member2=\"\">\n<p>删除数据</p>\n<blockquote>\n<p>srem key member1</p>\n</blockquote>\n</li>\n<li>\n<p>获取集合数据总数</p>\n<blockquote>\n<p>scard key</p>\n</blockquote>\n</li>\n<li>\n<p>判断集合中是否包含指定数据</p>\n<blockquote>\n<p>sismember key member</p>\n</blockquote>\n</li>\n</ol>\n<h3 id=\"拓展操作-4\"><a class=\"anchor\" href=\"#拓展操作-4\">#</a> <strong>拓展操作</strong></h3>\n<ol>\n<li count=\"\">\n<p>随机获取集合指定数量的数据</p>\n<blockquote>\n<p>srandmember key</p>\n</blockquote>\n</li>\n<li>\n<p>随机获取集合中的某个数据并将该数据移除集合</p>\n<blockquote>\n<p>spop key</p>\n</blockquote>\n</li>\n<li key2=\"\">\n<p>求两个集合的交、并、差集</p>\n<blockquote>\n<p key2=\"\">sinter key1</p>\n<p key2=\"\">sunion key1</p>\n<p>sdiff key1</p>\n</blockquote>\n</li>\n<li key2=\"\">\n<p>求两个集合的交、并、差并存储到指定集合中</p>\n<blockquote>\n<p key2=\"\">Sinterstore destination key1</p>\n<p key2=\"\">sunionstore destination key1</p>\n<p>sdiffstore destination key1</p>\n</blockquote>\n</li>\n<li>\n<p>将指定数据从原始集合移动到目标集合中</p>\n<blockquote>\n<p>smove source destination member</p>\n</blockquote>\n</li>\n</ol>\n<h2 id=\"sorted_set\"><a class=\"anchor\" href=\"#sorted_set\">#</a> <strong>sorted_set</strong></h2>\n<h3 id=\"基本操作-6\"><a class=\"anchor\" href=\"#基本操作-6\">#</a> <strong>基本操作</strong></h3>\n<ol key…=\"\">\n<li score2=\"\" member2=\"\">\n<p>添加数据</p>\n<blockquote>\n<p>zadd key score1 member1</p>\n</blockquote>\n</li>\n<li WINTHSCORES=\"\">\n<p>获取全部数据</p>\n<blockquote>\n<p>zrange key start stop [WINTHSCORES]</p>\n<p>zrevrange key start stop</p>\n</blockquote>\n</li>\n<li member=\"\" …=\"\">\n<p>删除数据</p>\n<blockquote>\n<p>zrem key member</p>\n</blockquote>\n</li>\n<li WINTHSCORES=\"\">\n<p>按条件获取数据</p>\n<blockquote>\n<p LIMIT=\"\">zrangebyscore key min max {WINTHSCORES}</p>\n<p>zrevrangebyscore key min max</p>\n</blockquote>\n</li>\n<li>\n<p>条件删除数据</p>\n<blockquote>\n<p>zremrangebyrank key start stop</p>\n<p>zremrangebyscore key min max</p>\n</blockquote>\n</li>\n<li>\n<p>获取集合数量总数</p>\n<blockquote>\n<p>Zcard key</p>\n<p>Zcount key min max</p>\n</blockquote>\n</li>\n<li>\n<p>集合交、并操作</p>\n<blockquote>\n<p>Zinterstore destination numkeys key {key …}    Zunionstore destination numkeys key</p>\n</blockquote>\n</li>\n</ol>\n<h3 id=\"拓展操作-5\"><a class=\"anchor\" href=\"#拓展操作-5\">#</a> <strong>拓展操作</strong></h3>\n<ol>\n<li>\n<p>获取数据对应的索引</p>\n<blockquote>\n<p>Zrank key member</p>\n<p>Zrevrank key member</p>\n</blockquote>\n</li>\n<li>\n<p>Score 值获取与修改</p>\n<blockquote>\n<p>Zscore key member</p>\n<p>Zincrby key increment member</p>\n</blockquote>\n</li>\n<li>\n<p>获取当前时间</p>\n<blockquote>\n<p>Time</p>\n</blockquote>\n</li>\n</ol>\n<h1 id=\"通用操作\"><a class=\"anchor\" href=\"#通用操作\">#</a> 通用操作</h1>\n<h2 id=\"key通用操作\"><a class=\"anchor\" href=\"#key通用操作\">#</a> Key 通用操作</h2>\n<h3 id=\"基本操作-7\"><a class=\"anchor\" href=\"#基本操作-7\">#</a> <strong>基本操作</strong></h3>\n<ol>\n<li>\n<p>删除指定 key</p>\n<blockquote>\n<p>del key</p>\n</blockquote>\n</li>\n<li>\n<p>获取 key 是否存在</p>\n<blockquote>\n<p>exists key</p>\n</blockquote>\n</li>\n<li>\n<p>获取 Key 的类型</p>\n<blockquote>\n<p>type key</p>\n</blockquote>\n</li>\n</ol>\n<h3 id=\"拓展操作-6\"><a class=\"anchor\" href=\"#拓展操作-6\">#</a> <strong>拓展操作</strong></h3>\n<ol>\n<li>\n<p>为指定的 key 设置有效期</p>\n<blockquote>\n<p>expire key seconds</p>\n<p>pexpire key milliseconds</p>\n<p>expireat key timestamp</p>\n<p>pexpireat key milliseconds-timestamp</p>\n</blockquote>\n</li>\n<li>\n<p>获取 key 的有效时间</p>\n<blockquote>\n<p>ttl key</p>\n<p>pttl key</p>\n</blockquote>\n</li>\n<li>\n<p>切换 key 从时效性转化为永久性</p>\n<blockquote>\n<p>persist key</p>\n</blockquote>\n</li>\n<li>\n<p>查询 key</p>\n<blockquote>\n<p>keys pattern</p>\n</blockquote>\n</li>\n<li>\n<p>例子</p>\n<blockquote>\n<p>keys *      查询所有</p>\n<p>keys it*     查询所有以 it 开头</p>\n<p>keys *it     查询所有以 it 结尾</p>\n<p>keys ??it    查询所有前面两个为任意字符，后面以 it 结尾</p>\n<p>keys user:?   查询所有以 user: 开头，最后一个字符任意</p>\n<p>keys u [st] er:1 查询所有以 u 开头，以 er:1 结尾，中间包含一个字母，s 或 t</p>\n</blockquote>\n</li>\n</ol>\n<h3 id=\"其他操作\"><a class=\"anchor\" href=\"#其他操作\">#</a> <strong>其他操作</strong></h3>\n<p>​       为 key 改名</p>\n<p>​       rename key newkey</p>\n<p>​       renamenx key newkey</p>\n<p>​       对所有 key 排序</p>\n<p>​       sort</p>\n<p>​       其他 key 通用操作</p>\n<p>​       help @generic</p>\n<h2 id=\"数据库通用操作\"><a class=\"anchor\" href=\"#数据库通用操作\">#</a> 数据库通用操作</h2>\n<h3 id=\"基本操作-8\"><a class=\"anchor\" href=\"#基本操作-8\">#</a> 基本操作</h3>\n<ol>\n<li>\n<p>切换数据库</p>\n<blockquote>\n<p>delect index</p>\n</blockquote>\n</li>\n<li>\n<p>其他操作</p>\n<blockquote>\n<p>quit</p>\n<p>ping</p>\n<p>echo message</p>\n</blockquote>\n</li>\n</ol>\n<h3 id=\"相关操作\"><a class=\"anchor\" href=\"#相关操作\">#</a> 相关操作</h3>\n<ol>\n<li>\n<p>数据移动</p>\n<blockquote>\n<p>move key db</p>\n</blockquote>\n</li>\n<li>\n<p>数据清除</p>\n<blockquote>\n<p>dbsize</p>\n<p>flushdb</p>\n<p>flushall</p>\n</blockquote>\n</li>\n</ol>\n<h1 id=\"jedis\"><a class=\"anchor\" href=\"#jedis\">#</a> <strong>Jedis</strong></h1>\n<ol>\n<li>\n<p>创建连接</p>\n<blockquote>\n<p>Jedis jedis = new Jedis(“127.0.0.1”,6379);</p>\n</blockquote>\n</li>\n<li>\n<p>添加元素</p>\n<blockquote>\n<p>jedis.set(“str”,123);</p>\n</blockquote>\n</li>\n<li>\n<p>关闭连接</p>\n</li>\n</ol>\n<blockquote>\n<p>jedis.close();</p>\n</blockquote>\n<h1 id=\"持久化\"><a class=\"anchor\" href=\"#持久化\">#</a> <strong>持久化</strong></h1>\n<blockquote>\n<p>RDB (记录数据) AOF (记录数据产生的过程)</p>\n</blockquote>\n<h2 id=\"rdb\"><a class=\"anchor\" href=\"#rdb\">#</a> RDB</h2>\n<blockquote>\n<p>save 立即保存，如果时间过长会阻塞客服端指令</p>\n<p>bgsave 针对 save 阻塞问题的优化</p>\n<p>save 配置</p>\n<p>save second changes</p>\n</blockquote>\n<h2 id=\"aof\"><a class=\"anchor\" href=\"#aof\">#</a> AOF</h2>\n<blockquote>\n<p>always (每次): 零误差，性能低</p>\n<p>everysec (每秒)：准确性较高，性能较高，可能丢失一秒内的数据</p>\n<p>no (系统控制)：整体过程不可控</p>\n<p>aof 重写（手动重写，自动重写）</p>\n</blockquote>\n<h1 id=\"事务\"><a class=\"anchor\" href=\"#事务\">#</a> 事务</h1>\n<h2 id=\"开事务\"><a class=\"anchor\" href=\"#开事务\">#</a> 开事务</h2>\n<blockquote>\n<p>multi</p>\n</blockquote>\n<ol>\n<li key2…=\"\">\n<p>对 key’添加监视锁，在执行 exec 前如果 key 发生了变化，终止事务执行</p>\n<blockquote>\n<p>watch key1</p>\n</blockquote>\n</li>\n<li>\n<p>取消对所有 key 的监视</p>\n<blockquote>\n<p>unwatch</p>\n</blockquote>\n</li>\n</ol>\n<h2 id=\"分布式锁\"><a class=\"anchor\" href=\"#分布式锁\">#</a> 分布式锁</h2>\n<p>使用 setnx 设置一个公共锁</p>\n<blockquote>\n<p>setnx lock-key value</p>\n<p>有值返回设置失败，无值返回设置成功</p>\n<p>对于返回设置成功的，拥有控制权，进行下一步的业务操作</p>\n<p>对于返回设置失败的，不具有控制权，排队或等待</p>\n</blockquote>\n<p>释放锁</p>\n<blockquote>\n<p>del lock-key</p>\n</blockquote>\n<p>解决死锁</p>\n<p>分布式锁改良</p>\n<blockquote>\n<p>使用 expire 为锁 key 添加时间限定，到时不释放，放弃锁</p>\n<p>expire lock-name second</p>\n<p>pexpire lock-name milliseconds</p>\n</blockquote>\n<h1 id=\"删除策略\"><a class=\"anchor\" href=\"#删除策略\">#</a> 删除策略</h1>\n<ol>\n<li>\n<p>定时删除</p>\n<blockquote>\n<p>优点：节约内存，到时就删除，快速释放不必要的内存占用</p>\n<p>缺点：cpu 压力大，无论 cpu 次数负载量多高，均占用 cpu</p>\n<p>拿 cpu 换内存</p>\n</blockquote>\n</li>\n<li>\n<p>惰性删除</p>\n<blockquote>\n<p>优点：节约 cpu 性能，发现必须删除的时候才删除</p>\n<p>缺点：内存压力大，出行长期占用内存的数据</p>\n<p>用存储空间换 cpu 性能</p>\n</blockquote>\n</li>\n<li>\n<p>定期删除</p>\n<blockquote>\n<p>Cpu 性能占用设置有峰值，检测频度可自定义设置</p>\n<p>内存压力不是很大，长期占用内存的类数据会被持续清理</p>\n<p>周期性抽查存储空间（随机抽查，重点抽查）</p>\n</blockquote>\n</li>\n</ol>\n<p>​    逐出算法</p>\n<h1 id=\"高级数据类型\"><a class=\"anchor\" href=\"#高级数据类型\">#</a> 高级数据类型</h1>\n<blockquote>\n<p><strong>Bitmaps</strong></p>\n<p><strong>HyperLogLog</strong></p>\n<p><strong>GEO</strong></p>\n</blockquote>\n<h1 id=\"redis集群\"><a class=\"anchor\" href=\"#redis集群\">#</a> Redis 集群</h1>\n",
            "tags": [
                "Redis"
            ]
        }
    ]
}